{"version":3,"file":"ReadBook.Bnhm7Qxr.js","sources":["../../../src/api/read.ts","../../../src/view/ReadBook/CatalogList.vue","../../../src/view/ReadBook/getArticle.vue","../../../src/view/ReadBook.vue"],"sourcesContent":["import request from '@/utils/request'\ninterface ArticleData<T> {\n  code: number\n  data: T\n  msg: string\n  state?: number\n}\n\n/** 获取小说章节列表 */\nexport const getBooksListAPI = <T>(url: string, data?: any) => {\n  return request<ArticleData<T>>(url, 'GET', data)\n}\n\n/** 获取小说章节列表 */\nexport const getArticleNameListAPI = <T>(url: string, data?: any) => {\n  return request<ArticleData<T>>(url, 'GET', data)\n}\n","<script setup lang=\"ts\">\nimport { nextTick, onMounted, ref, useTemplateRef, watch } from 'vue'\nimport { IDataList } from './getArticle.vue'\ninterface IProps {\n  articleNameList: IDataList[]\n  page: number\n}\nconst props = defineProps<IProps>()\nconst emits = defineEmits<{\n  (e: 'sendPage', data: IDataList): void\n}>()\nconst logRef = ref<HTMLDivElement>()\nconst activeIndex = ref<number>(1)\n\nconst handleClick = (item: IDataList) => {\n  emits('sendPage', item)\n  activeIndex.value = item.page\n}\nconst handleScroll = async () => {\n  await nextTick()\n  console.log('logRef.value--->', logRef.value)\n  if (logRef.value) {\n    console.log('滚动')\n    logRef.value?.scrollBy({\n      top: -50,\n      behavior: 'smooth'\n    })\n  }\n}\n\nonMounted(() => {\n  ////\n  //\n  handleScroll()\n})\n\nwatch(\n  () => props.page,\n  (val) => {\n    activeIndex.value = val\n  }\n)\n</script>\n\n<template>\n  <div class=\"catalog-box\">\n    <el-scrollbar height=\"80%\">\n      <div\n        class=\"log\"\n        v-for=\"item in articleNameList\"\n        :key=\"item.page\"\n        :class=\"activeIndex === item.page ? 'activeBox' : ''\"\n        @click=\"handleClick(item)\"\n      >\n        {{ '第' + item.page + '章：' + item.title }}\n      </div>\n    </el-scrollbar>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.catalog-box {\n  width: 100%;\n  height: 100%;\n  .log {\n    width: 100%;\n    height: 50px;\n    line-height: 50px;\n    box-sizing: border-box;\n    padding-left: 5px;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n    font-size: 14px;\n    border-bottom: 1px solid #ccc;\n    cursor: pointer;\n    &:hover {\n      color: #ad8484;\n    }\n  }\n  .activeBox {\n    color: #ad8484;\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { getArticleNameListAPI, getBooksListAPI } from '@/api/read'\nimport { getStorageByKey, setStorageByKey } from '@/utils/token'\nimport { ElMessage } from 'element-plus'\nimport { onMounted, ref } from 'vue'\nimport CataLogList from './CatalogList.vue'\n\nexport interface IDataAPI {\n  title: string\n  content: string\n  pageNumber: number\n  [key: string]: any\n}\nexport interface IDataList {\n  title: string\n  page: number\n}\n\nconst emits = defineEmits<{\n  (e: 'sendData', data: IDataAPI): void\n}>()\n\nconst PAGE_KEY = 'page_article'\nconst page = ref<number>(1)\nconst text = ref<string>('1')\nconst data = ref<IDataAPI>() // 文章内容\nconst articleNameList = ref<IDataList[]>([])\nconst handleChange = () => {\n  text.value = page.value.toString()\n}\n\n/** 获取小说 */\nconst getArticle = async (num: number) => {\n  try {\n    const res = await getBooksListAPI<IDataAPI>('/get/article', { page: num })\n    if (res.code === 10000) {\n      return res.data\n    }\n  } catch (error) {\n    console.error('Error reading file:', error)\n  }\n  return { title: '获取失败', content: '获取失败', pageNumber: page.value }\n}\n/**\n * 处理回车事件\n * @param evt - 事件对象\n */\nconst handleClick = (evt: Event) => {\n  const inputValue = (evt.target as HTMLInputElement).value\n  let pageNumber = parseInt(inputValue, 10)\n  if (isNaN(pageNumber)) {\n    pageNumber = 1\n    ElMessage.warning('请输入有效的数字')\n  } else if (pageNumber < 1) {\n    pageNumber = 1\n    ElMessage.warning('页码不能小于1')\n  } else {\n    ElMessage.success(`当前页码为 ${pageNumber}`)\n  }\n  page.value = pageNumber\n  handleData(page.value)\n}\n\n/** 上一章/下一章 */\nconst handlePageSum = async (num: number) => {\n  if (page.value <= 1 && num === -1) {\n    ElMessage.warning('已经是第一页了')\n    return\n  }\n  page.value = page.value + num\n  handleData(page.value)\n}\n\nasync function handleData(num: number) {\n  handleChange()\n  const res = await getArticle(num)\n  data.value = res\n  emits('sendData', res)\n  setStorageByKey(PAGE_KEY, num.toString())\n}\n\nfunction init() {\n  page.value = getStorageByKey(PAGE_KEY)\n  handleData(page.value)\n}\n\n/** 获取小说章节列表 */\nconst getArticleNameList = async () => {\n  const res = await getArticleNameListAPI<IDataList[]>('/get/article/names')\n  if (res.code !== 10000) return\n  articleNameList.value = res.data\n}\nconst sendPage = (item: IDataList) => {\n  page.value = item.page\n  handleData(item.page)\n}\n\nonMounted(() => {\n  init()\n  getArticleNameList()\n  console.log('000--->', page.value)\n})\n</script>\n\n<template>\n  <div class=\"get-article\">\n    <div class=\"top\">\n      <el-button @click=\"handlePageSum(-1)\"><</el-button>\n      <el-input v-model=\"text\" class=\"input\" @keydown.enter=\"handleClick\" @change=\"handleChange\"></el-input>\n      <el-button @click=\"handlePageSum(1)\">></el-button>\n    </div>\n    <div class=\"catalog\">\n      <CataLogList :articleNameList=\"articleNameList\" :page=\"page\" @sendPage=\"sendPage\" />\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.get-article {\n  display: flex;\n  flex-direction: column;\n  justify-content: start;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  background-color: #f0f0f0;\n  .top {\n    display: flex;\n    align-items: center;\n    max-height: 100px;\n    justify-content: space-between;\n    .input {\n      width: 100%;\n    }\n  }\n  .catalog {\n    flex: 1;\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { computed, ref } from 'vue'\nimport GetArticle, { IDataAPI } from '@/view/ReadBook/getArticle.vue'\n\nconst fileContent = ref<string>('选择章节')\nconst title = ref<string>('')\nconst page = ref<number>(0)\nconst sendData = (data: IDataAPI) => {\n  fileContent.value = data.content\n  title.value = data.title\n  page.value = data.pageNumber\n}\n\nconst titleH2 = computed(() => {\n  if (!title.value) return '选择章节'\n  return `第${page.value}章: ${title.value}`\n})\n</script>\n\n<template>\n  <div class=\"read-box\">\n    <div class=\"setting\">\n      <GetArticle @sendData=\"sendData\" />\n    </div>\n    <div class=\"read\">\n      <el-scrollbar height=\"100%\">\n        <h2>{{ titleH2 }}</h2>\n        <pre>{{ fileContent }}</pre>\n      </el-scrollbar>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.read-box {\n  display: flex;\n  justify-content: space-between;\n  gap: 1px;\n  width: 100%;\n  height: 100%;\n  background-color: #f0f0f0;\n  overflow: auto;\n  .setting {\n    width: 200px;\n    height: 100%;\n    border-right: 1px solid #ccc;\n  }\n  .read {\n    flex: 1;\n    height: 100%;\n    padding: 10px;\n    box-sizing: border-box;\n    overflow: hidden;\n    pre {\n      height: 100%;\n      width: 100%;\n      white-space: pre-wrap;\n      word-wrap: break-word;\n      overflow: auto;\n      padding-bottom: 15px;\n      font-size: 25px;\n    }\n  }\n}\n</style>\n"],"names":["getBooksListAPI","url","data","request","getArticleNameListAPI","props","__props","emits","__emit","logRef","ref","activeIndex","handleClick","item","handleScroll","nextTick","onMounted","watch","val","PAGE_KEY","page","text","articleNameList","handleChange","getArticle","num","res","error","evt","inputValue","pageNumber","ElMessage","handleData","handlePageSum","setStorageByKey","init","getStorageByKey","getArticleNameList","sendPage","fileContent","title","sendData","titleH2","computed"],"mappings":"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"}